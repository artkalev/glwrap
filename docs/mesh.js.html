<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>mesh.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BaseTexture2D.html">BaseTexture2D</a><ul class='methods'><li data-type='method'><a href="BaseTexture2D.html#init">init</a></li><li data-type='method'><a href="BaseTexture2D.html#setActive">setActive</a></li><li data-type='method'><a href="BaseTexture2D.html#update">update</a></li></ul></li><li><a href="Camera.html">Camera</a><ul class='methods'><li data-type='method'><a href="Camera.html#addChild">addChild</a></li><li data-type='method'><a href="Camera.html#draw">draw</a></li><li data-type='method'><a href="Camera.html#NDCToWorld">NDCToWorld</a></li><li data-type='method'><a href="Camera.html#onBeforeDraw">onBeforeDraw</a></li><li data-type='method'><a href="Camera.html#screenToWorld">screenToWorld</a></li><li data-type='method'><a href="Camera.html#setActive">setActive</a></li><li data-type='method'><a href="Camera.html#setParent">setParent</a></li><li data-type='method'><a href="Camera.html#update">update</a></li><li data-type='method'><a href="Camera.html#updateMatrix">updateMatrix</a></li><li data-type='method'><a href="Camera.html#updateProjectionMatrix">updateProjectionMatrix</a></li><li data-type='method'><a href="Camera.html#updateViewProjectionMatrix">updateViewProjectionMatrix</a></li></ul></li><li><a href="DataTexture2D.html">DataTexture2D</a><ul class='methods'><li data-type='method'><a href="DataTexture2D.html#init">init</a></li><li data-type='method'><a href="DataTexture2D.html#setActive">setActive</a></li><li data-type='method'><a href="DataTexture2D.html#update">update</a></li></ul></li><li><a href="Framebuffer2D.html">Framebuffer2D</a><ul class='methods'><li data-type='method'><a href="Framebuffer2D.html#init">init</a></li><li data-type='method'><a href="Framebuffer2D.html#setActive">setActive</a></li><li data-type='method'><a href="Framebuffer2D.html#update">update</a></li></ul></li><li><a href="Mat4.html">Mat4</a><ul class='methods'><li data-type='method'><a href="Mat4.html#copy">copy</a></li><li data-type='method'><a href="Mat4.html#identity">identity</a></li><li data-type='method'><a href="Mat4.html#invert">invert</a></li><li data-type='method'><a href="Mat4.html#multiply">multiply</a></li><li data-type='method'><a href="Mat4.html#orthogonal">orthogonal</a></li><li data-type='method'><a href="Mat4.html#perspective">perspective</a></li><li data-type='method'><a href="Mat4.html#trs">trs</a></li><li data-type='method'><a href="Mat4.html#zero">zero</a></li></ul></li><li><a href="Mesh.html">Mesh</a><ul class='methods'><li data-type='method'><a href="Mesh.html#draw">draw</a></li><li data-type='method'><a href="Mesh.html#getAttribute">getAttribute</a></li><li data-type='method'><a href="Mesh.html#loadOBJ">loadOBJ</a></li></ul></li><li><a href="MeshAttribute.html">MeshAttribute</a><ul class='methods'><li data-type='method'><a href="MeshAttribute.html#bind">bind</a></li><li data-type='method'><a href="MeshAttribute.html#init">init</a></li><li data-type='method'><a href="MeshAttribute.html#setData">setData</a></li><li data-type='method'><a href="MeshAttribute.html#update">update</a></li></ul></li><li><a href="Quat.html">Quat</a><ul class='methods'><li data-type='method'><a href="Quat.html#multiply">multiply</a></li><li data-type='method'><a href="Quat.html#rotateX">rotateX</a></li><li data-type='method'><a href="Quat.html#rotateY">rotateY</a></li><li data-type='method'><a href="Quat.html#rotateZ">rotateZ</a></li><li data-type='method'><a href="Quat.html#setAxisAngle">setAxisAngle</a></li><li data-type='method'><a href="Quat.html#setEuler">setEuler</a></li></ul></li><li><a href="Scene.html">Scene</a><ul class='methods'><li data-type='method'><a href="Scene.html#addTransform">addTransform</a></li><li data-type='method'><a href="Scene.html#draw">draw</a></li><li data-type='method'><a href="Scene.html#update">update</a></li></ul></li><li><a href="ShaderProgram.html">ShaderProgram</a><ul class='methods'><li data-type='method'><a href="ShaderProgram.html#compile">compile</a></li><li data-type='method'><a href="ShaderProgram.html#use">use</a></li></ul></li><li><a href="Texture2D.html">Texture2D</a><ul class='methods'><li data-type='method'><a href="Texture2D.html#init">init</a></li><li data-type='method'><a href="Texture2D.html#setActive">setActive</a></li><li data-type='method'><a href="Texture2D.html#update">update</a></li></ul></li><li><a href="Transform.html">Transform</a><ul class='methods'><li data-type='method'><a href="Transform.html#addChild">addChild</a></li><li data-type='method'><a href="Transform.html#draw">draw</a></li><li data-type='method'><a href="Transform.html#onBeforeDraw">onBeforeDraw</a></li><li data-type='method'><a href="Transform.html#setParent">setParent</a></li><li data-type='method'><a href="Transform.html#update">update</a></li><li data-type='method'><a href="Transform.html#updateMatrix">updateMatrix</a></li></ul></li><li><a href="Vec3.html">Vec3</a><ul class='methods'><li data-type='method'><a href="Vec3.html#copy">copy</a></li><li data-type='method'><a href="Vec3.html#cross">cross</a></li><li data-type='method'><a href="Vec3.html#dot">dot</a></li><li data-type='method'><a href="Vec3.html#isZero">isZero</a></li><li data-type='method'><a href="Vec3.html#length">length</a></li><li data-type='method'><a href="Vec3.html#lengthSqr">lengthSqr</a></li><li data-type='method'><a href="Vec3.html#normalize">normalize</a></li><li data-type='method'><a href="Vec3.html#transformMat4">transformMat4</a></li><li data-type='method'><a href="Vec3.html#.cross">cross</a></li><li data-type='method'><a href="Vec3.html#.dot">dot</a></li></ul></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">mesh.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {MeshAttribute} from './meshAttribute.js';

/**
 * Flexible geometry class to draw things with webgl.
 * Different meshes can even share {@link MeshAttribute} objects&lt;br>
 * provided that the vertexCount matches.
 * @example
 * // creating a 2D triangle mesh with position and uv attributes.
 * let position = new MeshAttribute(
 *      "position", // name
 *      new Float32Array([-1.0,-1.0, 0.0,1.0, 1.0,-1.0]), // data
 *      2, // size per vertex (2D vector in this case)
 *      'FLOAT', // data type
 *      false // is data normalized in glsl
 * );
 * let uv = new MeshAttribute(
 *      "uv",
 *      new Uint8Array([0,0, 128,255, 255,0]),
 *      2,
 *      'UNSIGNED_BYTE',
 *      true
 * );
 * let mesh = new Mesh([position, uv]);
 * mesh.draw(gl, program); // program must have uniforms set before drawing!
 */
export class Mesh{
    /**
     * 
     * @param {MeshAttribute[]} attributes attributes for this mesh. must contain an attribute named: 'position'.
     */
    constructor( attributes ){
        /**
         * Mesh Attributes
         * @type {MeshAttribute[]}
         */
        this.attributes = attributes;
        /**
         * Vertex count for this mesh. This is calculated from an attribute named "position"&lt;br>which MUST be present in the attributes array.
         * @type {Number}
         * @readonly
         */
        this.vertexCount = 0;
        /** 
         * Drawing mode of the mesh
         * @type {String}
         * @default 'TRIANGLES'
         * @see https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants#Rendering_primitives
         */
        this.drawMode = 'TRIANGLES';
    }
    /**
     * Returns a mesh attribute by name
     * @param {String} name
     * @returns {MeshAttribute} attribute
     */
    getAttribute(name){
        for(let i = 0; i &lt; this.attributes.length; i++){
            if(this.attributes[i].name == name){return this.attributes[i];}
        }
    }
    /**
     * Binds all attributes and draws the mesh.
     * @param {WebGLRenderingContext} gl 
     * @param {ShaderProgram} program 
     */
    draw(gl, program){
        for(let i = 0; i &lt; this.attributes.length; i++){
            let a = this.attributes[i];
            if(!a.isInitialized){ a.init(gl); }
            if(a.needsUpdate){ a.update(gl); }
            if(a.name == 'position'){this.vertexCount = a.data.length / a.size;}
            a.bind(gl, program);
        }
        if(this.vertexCount == 0){ return; }

        gl.drawArrays(gl[this.drawMode], 0, this.vertexCount);
        gl.bindBuffer(gl.ARRAY_BUFFER, null);
    }
    /**
     * Loads Mesh attributes from .obj file. The obje must be triangulated and both uv and normal data must be present.
     * @param {String} url path to the .obj file.
     */
    loadOBJ(url){
        this.xhttp = new XMLHttpRequest();
        this.xhttp.mesh = this;
        this.xhttp.overrideMimeType("text/plain");
        this.xhttp.onreadystatechange = function(){
            if(this.readyState == 4 &amp;&amp; this.status == 200){
                let file_verts = [];
                let file_uvs = [];
                let file_normals = [];
                let mesh_verts = [];
                let mesh_uvs = [];
                let mesh_normals = [];
                let lines = this.responseText.split('\n');
                for(let i = 0; i &lt; lines.length; i++){
                    let lineargs = lines[i].split(' ');
                    if(lineargs[0] == 'v'){
                        file_verts.push( [lineargs[1],lineargs[2],lineargs[3]] );
                    }else if(lineargs[0] == 'vt'){
                        file_uvs.push( [lineargs[1],lineargs[2]] );
                    }else if(lineargs[0] == 'vn'){
                        file_normals.push( [lineargs[1],lineargs[2],lineargs[3]] );
                    }else if(lineargs[0] == 'f'){
                        let v0 = lineargs[1].split('/');
                        let v1 = lineargs[2].split('/');
                        let v2 = lineargs[3].split('/');
                        mesh_verts.push( 
                            file_verts[v0[0]-1][0],file_verts[v0[0]-1][1],file_verts[v0[0]-1][2], 
                            file_verts[v1[0]-1][0],file_verts[v1[0]-1][1],file_verts[v1[0]-1][2],
                            file_verts[v2[0]-1][0],file_verts[v2[0]-1][1],file_verts[v2[0]-1][2]
                        );
                        mesh_uvs.push( 
                            file_uvs[v0[1]-1][0],file_uvs[v0[1]-1][1], 
                            file_uvs[v1[1]-1][0],file_uvs[v1[1]-1][1], 
                            file_uvs[v2[1]-1][0],file_uvs[v2[1]-1][1], 
                        );
                        mesh_normals.push( 
                            file_normals[v0[2]-1][0],file_normals[v0[2]-1][1],file_normals[v0[2]-1][2], 
                            file_normals[v1[2]-1][0],file_normals[v1[2]-1][1],file_normals[v1[2]-1][2],
                            file_normals[v2[2]-1][0],file_normals[v2[2]-1][1],file_normals[v2[2]-1][2]
                        );
                    }
                }
                this.mesh.attributes = [
                    new MeshAttribute('position', new Float32Array( mesh_verts ), 3, 'FLOAT', false, 'STATIC_DRAW'),
                    new MeshAttribute('uv', new Float32Array( mesh_uvs ), 2, 'FLOAT', false, 'STATIC_DRAW'),
                    new MeshAttribute('normal', new Float32Array( mesh_normals ), 3, 'FLOAT', false, 'STATIC_DRAW')
                ];
            }
        };
        this.xhttp.open("GET", url, true);
        this.xhttp.send();
    }
}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Jan 15 2019 09:38:45 GMT+0200 (EET) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>


</body>
</html>
